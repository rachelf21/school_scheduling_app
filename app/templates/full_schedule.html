{% extends "base.html" %} {% block title %}MDY Schedule{% endblock %} {% block content %}

<div class="d-flex justify-content-around" style="border: 0px solid red">
  <button id="next" class="btn btn-sm" onclick="get_prev()" style="display: block">
    <i class="fa fa-angle-left text-muted" style="font-size: 36px"></i>
  </button>
  <h1 class="mt-1 4 text-center font-weight-normal">{{title}}</h1>
  <button id="prev" class="btn btn-sm" onclick="get_next()" style="display: block">
    <i class="fa fa-angle-right text-muted" style="font-size: 36px"></i>
  </button>
</div>
<div class="table-responsive">
  <table
    id="myTable"
    class="table mx-auto table-striped table-hover table-bordered text-center mt-4 pt-4 w-auto table-fixed"
    style="border: 0px solid green; width: auto; margin: 0px auto"
  >
    <thead>
      <th>Per</th>
      <th>Time</th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
      <th>Thursday</th>
    </thead>

    <tbody>
      {% for schedule in schedule %}

      <tr>
        <script>
          console.log("hello there");
          var wk = "{{current_week}}";
          var dow = ["A_M", "A_T", "A_W", "A_Th"]; //change this to wk variable later
          var per = [0, 1, 2, 3, 4, 5, -1, 6, 7, 8, 9, 10];
          //var per = parseInt({{ schedule.sort}})
        </script>
        <td>
          <script>
            if (per[{{loop.index}}] != -1) document.write(per[{{loop.index}}]);
            else document.write("L");
          </script>
        </td>
        <td>
          <script>
            var start = "{{ schedule.period.start_time}}".substring(0, 5);
            var stop_time = "{{ schedule.period.end_time}}".substring(0, 5);
            document.write(start + "<br>-<br> " + stop_time);
          </script>
        </td>
        <td id="Mon">
          <script>
                console.log("working");
                var periodid = 'A_M'+per[{{loop.index}}];
                console.log(periodid);
              if ("{{ schedule.scheduleid}}" == periodid ){

                if ("{{ schedule.course.subject}}" == "0") {
                    document.write("");
                }
                else  {
                    document.write("{{ schedule.course.subject}}<br>");
                    var course = "{{ schedule.course.classid}}"+"-{{ schedule.course.subject}}";
                    var p = per[{{loop.index}}];
                    var c = "{{ schedule.course.classid}}";
                    var courseid = "{{ schedule.course.courseid}}";
                    //var t = '<a href="/today/' + c + '/' + dow + '/' +p + '">' + c + "</a>";
                    var t = '<a href="/attendance/' + c + '/' + courseid + '/' + dow + '/' +p + '">' + c + "</a>";
                    document.write(t+"<br>");
                    if ({{ schedule.course.room}} ==500)
                        document.write('Gym');
                    else
                        document.write("{{ schedule.course.room}}");

                    var s = "{{ schedule.course.subject}}" ;
                    if (s == "Computers" || s == "STEM") {
                        var x = "/lessons/"+course;
                                document.write('<br><a href="' + x + '">View</a>  &nbsp;|  ');
                            }

                            var t = '<a href="/addLesson/' + c + '/' + courseid + '/' + dow + '/' +p + '/a">' + "&nbsp; Add" + "</a>";
                            if (s == "Computers" || s == "STEM")  {
                                document.write(t);
                            } else document.write("");
                }
            } //Mon
          </script>
        </td>

        <td class="tues">Tuesday</td>
        <td class="wed">Wednesday</td>
        <td class="thurs">Thursday</td>
      </tr>

      {%endfor%}
    </tbody>
  </table>
</div>

<script>
  var current_week = "{{current_week}}";
  window.onload = function () {
    if (current_week == "A") {
      document.getElementById("weekA").classList.add("active");
      document.getElementById("weekB").classList.remove("active");
    } else if (current_week == "B") {
      document.getElementById("weekB").classList.add("active");
      document.getElementById("weekA").classList.remove("active");
    }
  };
</script>

<script>
  var sched = {{sched_list | tojson}};
  console.log(sched);

  function get_next(){
    var current = "{{dow}}";
    console.log(current);
    for(i=0; i< sched.length; i++){
      if(current.substring(2,4)=="Th"){
        //document.getElementById("next").disabled=true;
        next=sched[0];
        console.log("next day should be Mon " + next);
        window.location.href = "/schedule/" + next;
      }
      else if(sched[i]==current){
        next = sched[i+1];
        console.log("Next day: " + next);
        window.location.href = "/schedule/" + next;
      }
    }
  }


  function get_prev(){
    console.log("prev function");
    var current = "{{dow}}";
    //console.log(current);
    for(i=0; i< sched.length; i++){
      if(current.substring(2,3)=="M"){
        prev=sched[3];
        console.log("prev day should be Thurs " + prev);
        window.location.href = "/schedule/" + prev;
      }
      else if(sched[i]==current){
        prev = sched[i-1];
        console.log("prev day: " + prev);
        window.location.href = "/schedule/" + prev;
      }
    }
  }
</script>
<hr class="mt-4 mb-4" />

{% endblock content %}
